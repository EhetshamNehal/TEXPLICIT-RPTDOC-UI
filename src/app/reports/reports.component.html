<div class="main-body">
  <div class="title">
    <p><span class="bold-title-1">Create your AI enabled Reports</span> on any topic of your choice from content</p>
    <p>
      from the
      <span class="bold-title-2">INTERNET</span> or from your
      <span class="bold-title-2">DOCUMENT REPOSITORY</span>
    </p>
  </div>

  <div class="report-body">
    <div>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <!-- First Row -->
        <div class="first-row">
          <div fxLayout="row" fxLayout.xs="column" fxLayout.lt-md="column">
            <div class="first-row-first-section">
              <div fxLayout="column" class="topic-width">
                <div class="report-heading mr-20px">Topic</div>
                <div class="mr-20px">
                  <mat-form-field appearance="outline" class="search-wrapper mr-20px">
                    <input matInput #searchinput placeholder="Enter report topic here..." formControlName="task"
                      required />
                  </mat-form-field>
                </div>
              </div>
            </div>
            <div class="first-row-second-section">
              <div fxLayout="column">
                <div class="report-heading">Format</div>
                <div class="my-datasource-toolbar-config">
                  <mat-form-field appearance="outline" class="my-datasource-dropdown">
                    <mat-select #ddlDatasource placeholder="Please Select" formControlName="format">
                      <mat-option value="pdf">PDF</mat-option>
                      <mat-option value="word">Word</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>

              <div fxLayout="column">
                <div class="report-heading">Source</div>
                <div class="my-datasource-toolbar-config">
                  <mat-form-field appearance="outline" class="my-datasource-dropdown">
                    <mat-select #ddlDatasource placeholder="Please Select" formControlName="source">
                      <mat-option value="external">External</mat-option>
                      <mat-option value="my_documents">My Documents</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="first-row-third-section">
              <div fxLayout="row">
                <div fxLayout="column" class="report-type-order">
                  <div class="report-heading">Report type</div>
                  <div class="my-datasource-toolbar-config">
                    <mat-form-field appearance="outline" class="my-reports-dropdown">
                      <mat-select #ddlDatasource placeholder="Select report type" formControlName="report_type">
                        <mat-option value="outline_report">Outline Report</mat-option>
                        <mat-option value="research_report">Summary Report</mat-option>
                        <!-- <mat-option value="resource_report">Resource Report</mat-option> -->
                        <mat-option value="detailed_report">Detailed Report</mat-option>
                        <mat-option value="complete_report">Combined Report</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Second Row -->
        <div fxLayout="row" class="second-row">
          <button mat-raised-button type="button" *ngIf="
              form.get('report_type')?.value === 'detailed_report' ||
              form.get('report_type')?.value === 'complete_report'
            " class="btn-subtopics" (click)="getSubtopics()">
            Add Subtopics
          </button>
          <button mat-raised-button class="btn-report" type="submit" [disabled]="!form.valid">
            Generate Now
          </button>
          <div class="rep-gen-toolbar-config mr-left-top">
            <app-outer-toolbar-buttons [filterButtonVisible]="false" [groupMemberButtonVisible]="false"
              [noteButtonVisible]="false" [moreButtonVisible]="false" [backToParentButtonVisible]="false"
              [createFolderButtonVisible]="false" [refreshButtonVisible]="false" [uploadFileButtonVisible]="false"
              [configurationButtonVisible]="false" [historyButtonVisible]="false" [addUserButtonVisible]="false"
              [workspaceButtonVisible]="false" [addKnowledgeItemButtonVisible]="false" [newsButtonVisible]="false"
              (onReportProgress)="showLoadingReports()"></app-outer-toolbar-buttons>
          </div>
        </div>
      </form>
    </div>

    <div class="generated-reports-header" *ngIf="allReports.length !== 0">
      <div class="gen-report">
        <!-- <div fxLayout="column"> -->
        <div class="report-header">Generated Reports</div>
        <!-- </div> -->
        <!-- <div class="rep-gen-toolbar-config mr-left-15" >

          <app-outer-toolbar-buttons
              (onFilter)="onFilterClick()"
              [groupMemberButtonVisible]="false"
              [noteButtonVisible]="false"
              [moreButtonVisible]="false"
              [backToParentButtonVisible]="false"
              [createFolderButtonVisible]="false"
              [refreshButtonVisible]="false"
              [uploadFileButtonVisible]="false"
              [configurationButtonVisible]="false"
              [historyButtonVisible]="false"
              [addUserButtonVisible]="false"
              [workspaceButtonVisible]="false"
              [addKnowledgeItemButtonVisible]="false"
              [newsButtonVisible]="false"
              [reportProgressButtonVisible]="false"
              ></app-outer-toolbar-buttons>
        </div> -->
      </div>
    </div>

    <div style="position: relative">
      <div class="files-container  {{ displayStyle || 'list' }} ">
        <!-- write displayStyle.value if toggle button is kept -->
        <div class="file-header-content" *ngIf="allReports.length !== 0">
          <ul class="header-row">
            <li class="name-header">
              <div>Report</div>
              <button class="btn-sort" (click)="sortReports('task')">
                <mat-icon>unfold_more</mat-icon>
              </button>
            </li>
            <li class="size-header">
              <div>Topic</div>
            </li>
            <li class="date-header">
              <div>Date</div>
              <button class="btn-sort" (click)="sortReports('createdOn')">
                <mat-icon>keyboard_arrow_down</mat-icon>
              </button>
            </li>
            <li class="type-header">
              <div>Type</div>
              <button class="btn-sort" (click)="sortReports('report_type')">
                <mat-icon>keyboard_arrow_down</mat-icon>
              </button>
            </li>
            <li class="audio-header">
              <div>Report Audio</div>
            </li>
          </ul>
        </div>
        <div class="reports-loader" *ngIf="isLoading">
          <mat-spinner [diameter]="30"></mat-spinner>
        </div>
        <div class="report-steps top-40" *ngIf="allReports.length == 0 && isLoading == false && !isDismissed">
          <app-report-steps (dismissStep)="dismissSteps()"></app-report-steps>
        </div>
        <div class="file-body-content" *ngIf="allReports.length !== 0" (scroll)="onScroll($event)">
          <ng-container *ngFor="let report of allReports">
            <app-report-cards [report]="report" [displayStyle]="displayStyle" (deleteReport)="getAllReports()"
              (playAudioEvent)="onAudioDownload(report)" (stopAudioEvent)="stopAudio()"></app-report-cards>
          </ng-container>
        </div>
      </div>
    </div>
    <div [ngClass]="{'audio-player-hidden':!audioPlayerVisible}" class="audio-player">
      <audio controls #audioPlayer>
        Your browser does not support the audio element.
      </audio>
    </div>
  </div>
</div>
